---
import SocialMedia from "./SocialMedia.astro";
---

<section
  id="index"
  class="flex flex-col justify-center items-center w-full p-4 h-full relative"
>
  <div class="flex flex-col justify-center items-center gap-6">
    <h1
      data-aos="fade-up"
      class="text-white text-sm sm:text-2xl font-extrabold text-center bg-secondary p-2 px-4 rounded-2xl -rotate-4 uppercase"
    >
      <span class="block">
        <span class="font-mono">&lt;</span> Diseñador web,
      </span>
      <span class="block">
        tu proyecto, mi código <span class="font-mono">/&gt;</span>
      </span>
    </h1>
    <div data-aos="fade-up" data-aos-delay="200" class="flex flex-col gap-2">
      <div class="flex gap-1 items-end">
        <div class="bg-white rounded-full">
          <img
            src="/images/avatar.webp"
            alt="Foto de justdarian"
            class="w-30 h-30 rounded-full"
            loading="lazy"
          />
        </div>
        <h2 class="bg-white rounded-full p-2 px-4 text-lg font-extrabold">
          Hola, bienvenidos!
        </h2>
      </div>

      <div class="flex">
        <span
          class="bg-white rounded-full p-2 px-4 text-lg font-extrabold"
          aria-live="polite"
        >
          <span id="typewriter"></span><span id="cursor">|</span>
        </span>
      </div>
    </div>

    <div data-aos="fade-up" data-aos-delay="400" class="flex justify-center">
      <a
        href="#contact"
        aria-label="Ir a la sección de contacto"
        class="bg-secondary text-sm text-white font-extrabold rounded-full p-2 px-4 transition-transform duration-300 hover:scale-120 animate-[wiggle_1s_ease-in-out_infinite] uppercase"
      >
        Contactame !
      </a>
    </div>

    <div data-aos="fade-up" data-aos-delay="600">
      <SocialMedia />
    </div>
    <div data-aos="zoom-in" data-aos-delay="1200" class="animate-bounce inline">
      <a href="#services" aria-label="Desplazate hacia la sección de servicios">
        <img
          src="/images/backhand-index-pointing-down.svg"
          alt=""
          aria-hidden="true"
        />
      </a>
    </div>
  </div>

  <script>
    const texts = [
      "Soy Darian...",
      "Soy desarrollador...",
      "Diseño y desarrollo tu web...",
      "Sitios rápidos y con estilo...",
      "Te ayudo a crecer online!",
    ];

    const typewriter = document.getElementById("typewriter");
    const cursor = document.getElementById("cursor");

    let currentText = 0;
    let currentContent = "";
    const speed = 70;

    setInterval(() => {
      if (cursor)
        cursor.style.visibility =
          cursor.style.visibility === "visible" ? "hidden" : "visible";
    }, 500);

    function getCommonPrefix(a: string, b: string) {
      let i = 0;
      while (i < a.length && i < b.length && a[i] === b[i]) i++;
      return i;
    }

    function type() {
      const nextText = texts[currentText];
      const commonLength = getCommonPrefix(currentContent, nextText);

      if (currentContent.length > commonLength) {
        currentContent = currentContent.slice(0, currentContent.length - 1);
        if (typewriter) typewriter.textContent = currentContent;
        setTimeout(type, speed / 2);
      } else if (currentContent.length < nextText.length) {
        currentContent += nextText[currentContent.length];
        if (typewriter) typewriter.textContent = currentContent;
        setTimeout(type, speed);
      } else {
        setTimeout(() => {
          currentText = (currentText + 1) % texts.length;
          type();
        }, 2000);
      }
    }

    type();
  </script>

  <style is:global>
    @media (prefers-reduced-motion: reduce) {
      .animate-[wiggle_1s_ease-in-out_infinite],
      .animate-bounce,
      [data-aos] {
        animation: none !important;
        transition: none !important;
      }
    }
  </style>
</section>
